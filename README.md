# be-was-2024
코드스쿼드 백엔드 교육용 WAS 2024 개정판

## ✍️ Step7-1 게시판 기능 : 글쓰기 & 댓글 기능
### ⚒ step7-1 기능 구현 목록
- [x] 게시글을 올릴 수 있는 글쓰기 기능
- [x] 게시글이 없을 경우 게시글 없음을 표시하는 화면으로 응답하는 기능
- [x] 게시글마다 댓글을 추가하는 기능
- [x] 댓글을 접고 펼칠 수 있는 기능

### 🤔 설계 및 고민
#### request 요청 읽는 방식 변경
- 기존에는 BufferedReader를 이용해서 요청을 읽고 있었으나, request 요청은 바이트 배열 형식이기 때문에 텍스트를 읽는 BufferedReader는 적합한 방법이 아니었다.
- 따라서 한 줄씩 읽어야 하는 경우에는 BufferedInputStream을 이용해서 한 바이트씩 읽으며 CRLF를 찾고 이를 ByteArrayOutputStream에 저장하는 방식으로 읽도록 수정
- 그리고 특정 크기만큼 주어진 body를 읽는 경우에는 따로 buffer의 크기를 설정. 그 크기만큼 반복하며 읽어서 바이트 배열을 채워나가도록 했다.
#### 로그인 여부에 따라 동적/정적 응답으로 분기하는 기존 구조의 어색함 개선
- 요청이 들어오면 해당 클라이언트가 로그인 중인지 아닌지를 판단하여, 로그인 중이면 동적 핸들러, 아니라면 정적 핸들러로 보내도록 구성되어 있던 기존 로직
- 로그인 한 상태라면 화면을 랜더링하는데 필요한 css 파일이나 ico 파일 등등 리소스 파일 역시 동적 핸들러로 들어가서 처리되게 된다.
- 이러한 흐름을 가지는 구조가 어색하다는 피드백을 반영하여, 동적 응답이 필요한 url들을 따로 관리하고, 핸들러 진입 이후에 로그인 여부를 판별하는 것으로 구조를 변경했다.
#### 이전 글 다음 글 구현? 동적으로 브라우저가 정보를 받아서 화면에 랜더링하도록 어떻게 할 수 있을까?
- 이전 글 / 다음 글 버튼을 누를 때마다 서버로 요청을 보내는 것이 아니라, 클라이언트가 모든 게시글의 정보를 한 번에 응답받아서 값을 가지고 있다가
버튼이 클릭될 때 다른 게시글을 보여주도록 하고 싶었다.
- 하지만 시도 끝에 잘 되지 않아서 일단 보류🥲
#### 게시글과 댓글을 어떻게 연결할 것인가?
- 댓글을 작성해서 서버로 요청을 보낼 때, 어떤 글에 대한 댓글인지의 정보가 필요하다.  
    &rarr; 댓글을 작성할 때마다 글 id를 포함하도록 하자
- 이를 위해 댓글 작성 창으로 가는 get 요청 시, /comment?article-id=0 과 같이 쿼리를 포함해서 요청을 보내도록 구현
- 댓글 작성 창에서 최종적으로 /submit-comment으로 댓글 내용을 등록할 때, article-id 요소를 가져와서 요청 본문에 포함